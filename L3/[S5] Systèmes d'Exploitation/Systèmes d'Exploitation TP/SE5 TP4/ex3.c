#include <stdio.h>
#include <stdlib.h>
#include <sys/types.h>
#include <sys/stat.h>
#include <unistd.h>
#include <dirent.h>

//3.
int searchFather(struct stat st){
	int root_inode=st.st_ino;
	if(root_inode==2) return 1;//à la racine

	if(chdir("..")!=0){//va dans le répertoire supérieur
		printf("échec chdir");
		return 1;
	}
	DIR * dir=opendir(".");//et l'ouvre
	if(dir==NULL){
		printf("erreur lors de l'ouverture du répertoire parent");
		return 1;
	}
	
	struct dirent * entry;
	int inode;
	while((entry=readdir(dir))){//cherche le parent
		inode=entry->d_ino;
		if(inode==root_inode){
			if(lstat(".", &st)==-1){//parent devient courant pour récursion
				printf("échec stat");
				return 1;
			}
			int res=searchFather(st);//appel récursif
			printf("/%s", entry->d_name);
			closedir(dir);
			return res;
		}
	}
	return 0;//on a parcouru tous les répertoires possibles
}

int main(int argc, char* argv[]){
	if(argc!=1){
		printf("erreur nombre d'arguments\n");
		return 1;
	}
	
	struct stat st;
	if(lstat(".", &st)==-1){
		printf("échec stat\n");
		return 1;
	}
	int res=searchFather(st);
	printf("\n");
	return res;
}
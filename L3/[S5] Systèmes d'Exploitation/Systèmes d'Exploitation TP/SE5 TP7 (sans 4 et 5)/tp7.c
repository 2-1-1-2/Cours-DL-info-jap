#include "tp7.h"

void ex1(){
  printf("Mange tes épinards !\n");
  int non=1;
  switch(fork()){
    case -1:
      printf("error fork");
      exit(1);
    case 0:
      while(non){
        srand(time(NULL));
        non=rand()%2;
        if(non) printf("Non !\n");
        else printf("Oui papa...\n");
      }
      break;
    default:
      wait(NULL);
      printf("C'est bien !\n");
      exit(EXIT_SUCCESS);
  }
}

void ex2(){
  switch(fork()){
    case 0:
      printf("Louis I\n");
      switch(fork()){
        case 0:
          printf("Louis II\n");
          switch(fork()){
            case 0:
              printf("Louis III\n");
              switch(fork()){
                case 0:
                  printf("Louis IV\n");
                  switch(fork()){
                    case 0:
                      printf("Louis V\n");
                      switch(fork()){
                        case 0:
                          printf("Louis VI\n");
                          switch(fork()){
                            case 0:
                              printf("Louis VII\n");
                              switch(fork()){
                                case 0:
                                  printf("Louis VIII\n");
                                  switch(fork()){
                                    case 0:
                                      printf("Louis IX\n");
                                      break;
                                    default:
                                      wait(NULL);
                                      printf("Louis X\n");
                                  }
                                  break;
                                default:
                                  wait(NULL);
                                  printf("Louis XI\n");
                              }
                              break;
                            default:
                              wait(NULL);
                              printf("Louis XII\n");
                          }
                          break;
                        default:
                          wait(NULL);
                          printf("Louis XIII\n");
                      }
                      break;
                    default:
                      wait(NULL);
                      printf("Louis XIV\n");
                  }
                  break;
                default:
                  wait(NULL);
                  printf("Louis XV\n");
              }
              break;
            default:
              wait(NULL);
              printf("Louis XVI\n");
          }
          break;
        default:
          wait(NULL);
          printf("Louis XVII\n");
      }
      break;
    default:
      wait(NULL);
      printf("Louis XVIII\n");
  }
}

void ex3(){
  srand(time(NULL));
  int nb=rand()%3;
  switch(fork()){
    case -1:
      printf("error fork");
      exit(1);
    case 0:
      sleep(nb);
      break;
    default:
      while(waitpid(-1, NULL, WNOHANG)!=-1){
        printf("A table !\n");
        sleep(1);
      }
      printf("C'est pas trop tôt !\n");
      exit(EXIT_SUCCESS);
  }
}

int main(){
  //ex1();
  ex2();
  //ex3();
  return 0;
}
